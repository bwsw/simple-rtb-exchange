<?xml version="1.0" encoding="UTF-8"?>

<databaseChangeLog
        xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog
         http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.1.xsd">

    <changeSet id="1" author="Pavel Tomskikh">
        <createProcedure procedureName="update_tsversion">
            CREATE OR REPLACE FUNCTION update_tsversion() RETURNS TRIGGER AS $update_tsversion$
            BEGIN
            NEW.tsversion = extract(epoch from now())::bigint;
            RETURN NEW;
            END;
            $update_tsversion$ LANGUAGE plpgsql;
        </createProcedure>

        <createProcedure procedureName="insert_publisher">
            CREATE OR REPLACE FUNCTION insert_publisher()
            RETURNS TRIGGER AS $insert_publisher$
            BEGIN
            UPDATE publisher
            SET tsversion = extract(epoch from now())::bigint
            WHERE id = NEW.publisher_id;
            RETURN NEW;
            END;
            $insert_publisher$ LANGUAGE plpgsql;
        </createProcedure>

        <createProcedure procedureName="delete_publisher">
            CREATE OR REPLACE FUNCTION delete_publisher()
            RETURNS TRIGGER AS $delete_publisher$
            BEGIN
            UPDATE publisher
            SET tsversion = extract(epoch from now())::bigint
            WHERE id = OLD.publisher_id;
            RETURN NEW;
            END;
            $delete_publisher$ LANGUAGE plpgsql;
        </createProcedure>

        <createProcedure procedureName="insert_iab_category">
            CREATE OR REPLACE FUNCTION insert_iab_category()
            RETURNS TRIGGER AS $insert_iab_category$
            BEGIN
            UPDATE iab_category
            SET tsversion = extract(epoch from now())::bigint
            WHERE id = NEW.iab_category_id;
            RETURN NEW;
            END;
            $insert_iab_category$ LANGUAGE plpgsql;
        </createProcedure>

        <createProcedure procedureName="delete_iab_category">
            CREATE OR REPLACE FUNCTION delete_iab_category()
            RETURNS TRIGGER AS $delete_iab_category$
            BEGIN
            UPDATE iab_category
            SET tsversion = extract(epoch from now())::bigint
            WHERE id = OLD.iab_category_id;
            RETURN NEW;
            END;
            $delete_iab_category$ LANGUAGE plpgsql;
        </createProcedure>

        <createProcedure procedureName="insert_site">
            CREATE OR REPLACE FUNCTION insert_site()
            RETURNS TRIGGER AS $insert_site$
            BEGIN
            UPDATE site
            SET tsversion = extract(epoch from now())::bigint
            WHERE id = NEW.site_id;
            RETURN NEW;
            END;
            $insert_site$ LANGUAGE plpgsql;
        </createProcedure>

        <createProcedure procedureName="delete_site">
            CREATE OR REPLACE FUNCTION delete_site()
            RETURNS TRIGGER AS $delete_site$
            BEGIN
            UPDATE site
            SET tsversion = extract(epoch from now())::bigint
            WHERE id = OLD.site_id;
            RETURN NEW;
            END;
            $delete_site$ LANGUAGE plpgsql;
        </createProcedure>

        <createProcedure procedureName="insert_display_manager">
            CREATE OR REPLACE FUNCTION insert_display_manager()
            RETURNS TRIGGER AS $insert_display_manager$
            BEGIN
            UPDATE display_manager
            SET tsversion = extract(epoch from now())::bigint
            WHERE id = NEW.display_manager_id;
            RETURN NEW;
            END;
            $insert_display_manager$ LANGUAGE plpgsql;
        </createProcedure>

        <createProcedure procedureName="delete_display_manager">
            CREATE OR REPLACE FUNCTION delete_display_manager()
            RETURNS TRIGGER AS $delete_display_manager$
            BEGIN
            UPDATE display_manager
            SET tsversion = extract(epoch from now())::bigint
            WHERE id = OLD.display_manager_id;
            RETURN NEW;
            END;
            $delete_display_manager$ LANGUAGE plpgsql;
        </createProcedure>

        <rollback>
            <sql>DROP FUNCTION update_tsversion()</sql>
            <sql>DROP FUNCTION insert_publisher()</sql>
            <sql>DROP FUNCTION delete_publisher()</sql>
            <sql>DROP FUNCTION insert_iab_category()</sql>
            <sql>DROP FUNCTION delete_iab_category()</sql>
            <sql>DROP FUNCTION insert_site()</sql>
            <sql>DROP FUNCTION delete_site()</sql>
            <sql>DROP FUNCTION insert_display_manager()</sql>
            <sql>DROP FUNCTION delete_display_manager()</sql>
        </rollback>
    </changeSet>

    <changeSet id="2" author="Pavel Tomskikh">
        <preConditions>
            <not>
                <tableExists tableName="iab_category"/>
            </not>
        </preConditions>

        <createTable tableName="iab_category" remarks="IAB categories">
            <column name="id"
                    type="integer"
                    autoIncrement="true"
                    remarks="unique id">
                <constraints primaryKey="true"/>
            </column>

            <column name="iab_id"
                    type="varchar(8)"
                    remarks="IAB category id">
                <constraints nullable="false"/>
            </column>

            <column name="name"
                    type="varchar(64)"
                    remarks="IAB category description">
                <constraints nullable="false"/>
            </column>

            <column name="tsversion"
                    type="bigint"
                    defaultValue="extract(epoch from now())::bigint"
                    remarks="latest update time">
                <constraints nullable="false"/>
            </column>

            <column name="deleted"
                    type="boolean"
                    defaultValue="false"
                    remarks="indicates if row deleted">
                <constraints nullable="false"/>
            </column>

            <column name="parent_id"
                    type="integer"
                    remarks="identify parent category">
                <constraints nullable="true"
                             foreignKeyName="parent_id"
                             referencedTableName="iab_category"
                             referencedColumnNames="id"/>
            </column>
        </createTable>

        <createIndex tableName="iab_category"
                     indexName="iab_category_parent_id"
                     unique="false">
            <column name="parent_id" type="integer"/>
        </createIndex>

        <createProcedure procedureName="insert_child_iab_category">
            CREATE OR REPLACE FUNCTION insert_child_iab_category()
            RETURNS TRIGGER AS $insert_child_iab_category$
            BEGIN
            UPDATE iab_category
            SET tsversion = extract(epoch from now())::bigint
            WHERE id = NEW.parent_id;
            RETURN NEW;
            END;
            $insert_child_iab_category$ LANGUAGE plpgsql;
        </createProcedure>

        <createProcedure procedureName="delete_child_iab_category">
            CREATE OR REPLACE FUNCTION delete_child_iab_category()
            RETURNS TRIGGER AS $delete_child_iab_category$
            BEGIN
            UPDATE iab_category
            SET tsversion = extract(epoch from now())::bigint
            WHERE id = OLD.parent_id;
            RETURN NEW;
            END;
            $delete_child_iab_category$ LANGUAGE plpgsql;
        </createProcedure>

        <sql>
            CREATE TRIGGER iab_category_update
            BEFORE UPDATE ON iab_category
            FOR EACH ROW EXECUTE PROCEDURE update_tsversion()
        </sql>

        <sql>
            CREATE TRIGGER iab_cat_ins_child
            AFTER INSERT OR UPDATE ON iab_category
            FOR EACH ROW
            WHEN (NEW.parent_id IS NOT NULL)
            EXECUTE PROCEDURE insert_child_iab_category()
        </sql>

        <sql>
            CREATE TRIGGER iab_cat_del_child
            AFTER UPDATE OR DELETE ON iab_category
            FOR EACH ROW
            WHEN (OLD.parent_id IS NOT NULL)
            EXECUTE PROCEDURE delete_child_iab_category()
        </sql>

        <rollback>
            <dropTable tableName="iab_category"/>
            <sql>DROP FUNCTION insert_child_iab_category()</sql>
            <sql>DROP FUNCTION delete_child_iab_category()</sql>
        </rollback>
    </changeSet>

    <changeSet id="3" author="Pavel Tomskikh">
        <preConditions>
            <not>
                <tableExists tableName="publisher"/>
            </not>
        </preConditions>

        <createTable tableName="publisher"
                     remarks="Describes publisher">
            <column name="id"
                    type="integer"
                    autoIncrement="true"
                    remarks="unique id">
                <constraints primaryKey="true"/>
            </column>

            <column name="name"
                    type="varchar(128)"
                    remarks="publisher name">
                <constraints nullable="false"/>
            </column>

            <column name="domain"
                    type="varchar(128)"
                    remarks="publisher domain">
                <constraints nullable="false"/>
            </column>

            <column name="tsversion"
                    type="bigint"
                    defaultValue="extract(epoch from now())::bigint"
                    remarks="latest update time">
                <constraints nullable="false"/>
            </column>

            <column name="deleted"
                    type="boolean"
                    defaultValue="false"
                    remarks="indicates if row deleted">
                <constraints nullable="false"/>
            </column>
        </createTable>

        <sql>
            CREATE TRIGGER publisher_update
            BEFORE UPDATE ON publisher
            FOR EACH ROW EXECUTE PROCEDURE update_tsversion()
        </sql>

        <rollback>
            <dropTable tableName="publisher"/>
        </rollback>
    </changeSet>

    <changeSet id="4" author="Pavel Tomskikh">
        <preConditions>
            <not>
                <tableExists tableName="bidder"/>
            </not>
        </preConditions>

        <createTable tableName="bidder"
                     remarks="Describes bidder">
            <column name="id"
                    type="integer"
                    autoIncrement="true"
                    remarks="unique id">
                <constraints primaryKey="true"/>
            </column>

            <column name="name"
                    type="varchar(128)"
                    remarks="bidder name">
                <constraints nullable="false"/>
            </column>

            <column name="endpoint"
                    type="varchar(256)"
                    remarks="endpoint for BidRequest">
                <constraints nullable="false"/>
            </column>

            <column name="tsversion"
                    type="bigint"
                    defaultValue="extract(epoch from now())::bigint"
                    remarks="latest update time">
                <constraints nullable="false"/>
            </column>

            <column name="deleted"
                    type="boolean"
                    defaultValue="false"
                    remarks="indicates if row deleted">
                <constraints nullable="false"/>
            </column>
        </createTable>

        <sql>
            CREATE TRIGGER bidder_update
            BEFORE UPDATE ON bidder
            FOR EACH ROW EXECUTE PROCEDURE update_tsversion()
        </sql>

        <rollback>
            <dropTable tableName="bidder"/>
        </rollback>
    </changeSet>

    <changeSet id="5" author="Pavel Tomskikh">
        <preConditions>
            <not>
                <tableExists tableName="display_manager"/>
            </not>
        </preConditions>

        <createTable tableName="display_manager"
                     remarks="Describes software which renders ad">
            <column name="id"
                    type="integer"
                    autoIncrement="true"
                    remarks="unique id">
                <constraints primaryKey="true"/>
            </column>

            <column name="name"
                    type="varchar(128)"
                    remarks="diplay manager name">
                <constraints nullable="false"/>
            </column>

            <column name="ver"
                    type="varchar(16)"
                    remarks="display manager version">
                <constraints nullable="false"/>
            </column>

            <column name="tsversion"
                    type="bigint"
                    defaultValue="extract(epoch from now())::bigint"
                    remarks="latest update time">
                <constraints nullable="false"/>
            </column>

            <column name="deleted"
                    type="boolean"
                    defaultValue="false"
                    remarks="indicates if row deleted">
                <constraints nullable="false"/>
            </column>
        </createTable>

        <sql>
            CREATE TRIGGER display_manager_update
            BEFORE UPDATE ON display_manager
            FOR EACH ROW EXECUTE PROCEDURE update_tsversion()
        </sql>

        <rollback>
            <dropTable tableName="display_manager"/>
        </rollback>
    </changeSet>

    <changeSet id="6" author="Pavel Tomskikh">
        <preConditions>
            <not>
                <tableExists tableName="publisher_blocked_category"/>
            </not>
        </preConditions>

        <createTable tableName="publisher_blocked_category"
                     remarks="IAB content categories which blocked by publisher">
            <column name="publisher_id"
                    type="integer"
                    remarks="publisher">
                <constraints primaryKey="true"
                             foreignKeyName="publisher_id"
                             referencedTableName="publisher"
                             referencedColumnNames="id"/>
            </column>

            <column name="iab_category_id"
                    type="integer"
                    remarks="blocked category">
                <constraints primaryKey="true"
                             foreignKeyName="iab_category_id"
                             referencedTableName="iab_category"
                             referencedColumnNames="id"/>
            </column>
        </createTable>

        <createIndex tableName="publisher_blocked_category"
                     indexName="pub_bl_cat_cat_id"
                     unique="false">
            <column name="iab_category_id" type="integer"/>
        </createIndex>

        <createIndex tableName="publisher_blocked_category"
                     indexName="pub_bl_cat_pub_id"
                     unique="false">
            <column name="publisher_id" type="integer"/>
        </createIndex>

        <sql>
            CREATE TRIGGER pub_bl_cat_ins_cat
            AFTER INSERT OR UPDATE ON publisher_blocked_category
            FOR EACH ROW EXECUTE PROCEDURE insert_iab_category()
        </sql>

        <sql>
            CREATE TRIGGER pub_bl_cat_del_cat
            AFTER UPDATE OR DELETE ON publisher_blocked_category
            FOR EACH ROW EXECUTE PROCEDURE delete_iab_category()
        </sql>

        <sql>
            CREATE TRIGGER pub_bl_cat_ins_pub
            AFTER INSERT OR UPDATE ON publisher_blocked_category
            FOR EACH ROW EXECUTE PROCEDURE insert_publisher()
        </sql>

        <sql>
            CREATE TRIGGER pub_bl_cat_del_pub
            AFTER UPDATE OR DELETE ON publisher_blocked_category
            FOR EACH ROW EXECUTE PROCEDURE delete_publisher()
        </sql>

        <rollback>
            <dropTable tableName="publisher_blocked_category"/>
        </rollback>
    </changeSet>

    <changeSet id="7" author="Pavel Tomskikh">
        <preConditions>
            <not>
                <tableExists tableName="publisher_category"/>
            </not>
        </preConditions>

        <createTable tableName="publisher_category"
                     remarks="IAB content categories that describe the publisher">
            <column name="publisher_id"
                    type="integer"
                    remarks="publisher">
                <constraints primaryKey="true"
                             foreignKeyName="publisher_id"
                             referencedTableName="publisher"
                             referencedColumnNames="id"/>
            </column>

            <column name="iab_category_id"
                    type="integer"
                    remarks="category">
                <constraints primaryKey="true"
                             foreignKeyName="iab_category_id"
                             referencedTableName="iab_category"
                             referencedColumnNames="id"/>
            </column>
        </createTable>

        <createIndex tableName="publisher_category"
                     indexName="pub_cat_cat_id"
                     unique="false">
            <column name="iab_category_id" type="integer"/>
        </createIndex>

        <createIndex tableName="publisher_category"
                     indexName="pub_cat_pub_id"
                     unique="false">
            <column name="publisher_id" type="integer"/>
        </createIndex>

        <sql>
            CREATE TRIGGER pub_cat_ins_cat
            AFTER INSERT OR UPDATE ON publisher_category
            FOR EACH ROW EXECUTE PROCEDURE insert_iab_category()
        </sql>

        <sql>
            CREATE TRIGGER pub_cat_del_cat
            AFTER UPDATE OR DELETE ON publisher_category
            FOR EACH ROW EXECUTE PROCEDURE delete_iab_category()
        </sql>

        <sql>
            CREATE TRIGGER pub_cat_ins_pub
            AFTER INSERT OR UPDATE ON publisher_category
            FOR EACH ROW EXECUTE PROCEDURE insert_publisher()
        </sql>

        <sql>
            CREATE TRIGGER pub_cat_del_pub
            AFTER UPDATE OR DELETE ON publisher_category
            FOR EACH ROW EXECUTE PROCEDURE delete_publisher()
        </sql>

        <rollback>
            <dropTable tableName="publisher_category"/>
        </rollback>
    </changeSet>

    <changeSet id="8" author="Pavel Tomskikh">
        <preConditions>
            <not>
                <tableExists tableName="publisher_blocked_advertiser"/>
            </not>
        </preConditions>

        <createTable tableName="publisher_blocked_advertiser"
                     remarks="Advertisers which blocked by publisher">
            <column name="id"
                    type="integer"
                    autoIncrement="true"
                    remarks="unique id">
                <constraints primaryKey="true"/>
            </column>

            <column name="publisher_id"
                    type="integer"
                    remarks="publisher">
                <constraints nullable="false"
                             foreignKeyName="publisher_id"
                             referencedTableName="publisher"
                             referencedColumnNames="id"/>
            </column>

            <column name="domain"
                    type="varchar(128)"
                    remarks="blocked advertiser">
                <constraints nullable="false"/>
            </column>
        </createTable>

        <createIndex tableName="publisher_blocked_advertiser"
                     indexName="pub_bl_adv_pub_id"
                     unique="false">
            <column name="publisher_id" type="integer"/>
        </createIndex>

        <sql>
            CREATE TRIGGER pub_bl_adv_ins_pub
            AFTER INSERT OR UPDATE ON publisher_blocked_advertiser
            FOR EACH ROW EXECUTE PROCEDURE insert_publisher()
        </sql>

        <sql>
            CREATE TRIGGER pub_bl_adv_del_pub
            AFTER UPDATE OR DELETE ON publisher_blocked_advertiser
            FOR EACH ROW EXECUTE PROCEDURE delete_publisher()
        </sql>

        <rollback>
            <dropTable tableName="publisher_blocked_advertiser"/>
        </rollback>
    </changeSet>

    <changeSet id="9" author="Pavel Tomskikh">
        <preConditions>
            <not>
                <tableExists tableName="site"/>
            </not>
        </preConditions>

        <createTable tableName="site"
                     remarks="Describes site or app">
            <column name="id"
                    type="integer"
                    autoIncrement="true"
                    remarks="unique id">
                <constraints primaryKey="true"/>
            </column>

            <column name="publisher_id"
                    type="integer"
                    remarks="publisher associated with site/app">
                <constraints nullable="false"
                             foreignKeyName="publisher_id"
                             referencedTableName="publisher"
                             referencedColumnNames="id"/>
            </column>

            <column name="name"
                    type="varchar(128)"
                    remarks="site/app name">
                <constraints nullable="false"/>
            </column>

            <column name="type"
                    type="integer"
                    remarks="1 for site, 2 for app">
                <constraints nullable="false"/>
            </column>

            <column name="status"
                    type="integer"
                    remarks="site/app status">
                <constraints nullable="false"/>
            </column>

            <column name="privacy_policy"
                    type="integer"
                    remarks="indicates if the site/app has privacy policy">
                <constraints nullable="false"/>
            </column>

            <column name="test"
                    type="boolean"
                    remarks="indicates if the site/app is in test mode">
                <constraints nullable="false"/>
            </column>

            <column name="tsversion"
                    type="bigint"
                    defaultValue="extract(epoch from now())::bigint"
                    remarks="latest update time">
                <constraints nullable="false"/>
            </column>

            <column name="deleted"
                    type="boolean"
                    defaultValue="false"
                    remarks="indicates if row deleted">
                <constraints nullable="false"/>
            </column>

            <column name="domain"
                    type="varchar(128)"
                    remarks="domain of the"/>

            <column name="keyword"
                    type="varchar(1024)"
                    remarks="comma separated list of keywords about the site/app"/>

            <column name="app_bundle"
                    type="varchar(128)"
                    remarks="app bundle or package name"/>

            <column name="app_store_url"
                    type="varchar(256)"
                    remarks="app store URL for an installed apps"/>

            <column name="app_ver"
                    type="varchar(16)"
                    remarks="app version"/>
        </createTable>

        <createIndex tableName="site"
                     indexName="site_publisher_id"
                     unique="false">
            <column name="publisher_id" type="integer"/>
        </createIndex>

        <sql>
            ALTER TABLE site ADD CHECK (
            type = 1 AND
            domain IS NOT NULL OR
            type = 2 AND
            app_bundle IS NOT NULL AND
            app_store_url IS NOT NULL AND
            app_ver IS NOT NULL)
        </sql>

        <sql>
            CREATE TRIGGER site_update
            BEFORE UPDATE ON site
            FOR EACH ROW EXECUTE PROCEDURE update_tsversion()
        </sql>

        <sql>
            CREATE TRIGGER site_ins_pub
            AFTER INSERT OR UPDATE ON site
            FOR EACH ROW EXECUTE PROCEDURE insert_publisher()
        </sql>

        <sql>
            CREATE TRIGGER site_del_pub
            AFTER UPDATE OR DELETE ON site
            FOR EACH ROW EXECUTE PROCEDURE delete_publisher()
        </sql>

        <rollback>
            <dropTable tableName="site"/>
        </rollback>
    </changeSet>

    <changeSet id="10" author="Pavel Tomskikh">
        <preConditions>
            <not>
                <tableExists tableName="site_category"/>
            </not>
        </preConditions>

        <createTable tableName="site_category"
                     remarks="IAB content categories that describe site/app">
            <column name="site_id"
                    type="integer"
                    remarks="site">
                <constraints primaryKey="true"
                             foreignKeyName="site_id"
                             referencedTableName="site"
                             referencedColumnNames="id"/>
            </column>

            <column name="iab_category_id"
                    type="integer"
                    remarks="category">
                <constraints primaryKey="true"
                             foreignKeyName="iab_category_id"
                             referencedTableName="iab_category"
                             referencedColumnNames="id"/>
            </column>
        </createTable>

        <createIndex tableName="site_category"
                     indexName="site_cat_cat_id"
                     unique="false">
            <column name="iab_category_id" type="integer"/>
        </createIndex>

        <createIndex tableName="site_category"
                     indexName="site_cat_site_id"
                     unique="false">
            <column name="site_id" type="integer"/>
        </createIndex>

        <sql>
            CREATE TRIGGER site_cat_ins_site
            AFTER INSERT OR UPDATE ON site_category
            FOR EACH ROW EXECUTE PROCEDURE insert_site()
        </sql>

        <sql>
            CREATE TRIGGER site_cat_del_site
            AFTER UPDATE OR DELETE ON site_category
            FOR EACH ROW EXECUTE PROCEDURE delete_site()
        </sql>

        <sql>
            CREATE TRIGGER site_cat_ins_cat
            AFTER INSERT OR UPDATE ON site_category
            FOR EACH ROW EXECUTE PROCEDURE insert_iab_category()
        </sql>

        <sql>
            CREATE TRIGGER site_cat_del_cat
            AFTER UPDATE OR DELETE ON site_category
            FOR EACH ROW EXECUTE PROCEDURE delete_iab_category()
        </sql>

        <rollback>
            <dropTable tableName="site_category"/>
        </rollback>
    </changeSet>

    <changeSet id="11" author="Pavel Tomskikh">
        <preConditions>
            <not>
                <tableExists tableName="site_display_manager"/>
            </not>
        </preConditions>

        <createTable tableName="site_display_manager"
                     remarks="Display managers associated with the site/app">
            <column name="site_id"
                    type="integer"
                    remarks="site">
                <constraints primaryKey="true"
                             foreignKeyName="site_id"
                             referencedTableName="site"
                             referencedColumnNames="id"/>
            </column>

            <column name="display_manager_id"
                    type="integer"
                    remarks="associated display manager">
                <constraints primaryKey="true"
                             foreignKeyName="display_manager_id"
                             referencedTableName="display_manager"
                             referencedColumnNames="id"/>
            </column>
        </createTable>

        <createIndex tableName="site_display_manager"
                     indexName="site_dm_dm_id"
                     unique="false">
            <column name="display_manager_id" type="integer"/>
        </createIndex>

        <createIndex tableName="site_display_manager"
                     indexName="site_dm_site_id"
                     unique="false">
            <column name="site_id" type="integer"/>
        </createIndex>

        <sql>
            CREATE TRIGGER site_dm_ins_site
            AFTER INSERT OR UPDATE ON site_display_manager
            FOR EACH ROW EXECUTE PROCEDURE insert_site()
        </sql>

        <sql>
            CREATE TRIGGER site_dm_del_site
            AFTER UPDATE OR DELETE ON site_display_manager
            FOR EACH ROW EXECUTE PROCEDURE delete_site()
        </sql>

        <sql>
            CREATE TRIGGER site_dm_ins_cat
            AFTER INSERT OR UPDATE ON site_display_manager
            FOR EACH ROW EXECUTE PROCEDURE insert_display_manager()
        </sql>

        <sql>
            CREATE TRIGGER site_dm_del_cat
            AFTER UPDATE OR DELETE ON site_display_manager
            FOR EACH ROW EXECUTE PROCEDURE delete_display_manager()
        </sql>

        <rollback>
            <dropTable tableName="site_display_manager"/>
        </rollback>
    </changeSet>

</databaseChangeLog>
